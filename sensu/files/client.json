{%- from "sensu/pillar_map.jinja" import sensu with context %}
{
  "client": {
    {% if sensu.client.add_machine_id -%}
    "name": "{{ grains['fqdn'] }}-{{ grains['machine_id'] }}",
    {% else -%}
    "name": {{ grains['fqdn']|json }},
    {% endif -%}
    "address": {{ grains['ipv4'][0]|json }},
    "subscriptions": [ "all" ],
    "load": "iframe:http://metrics.oommm.de/render?from=-6hours&until=now&width=400&height=150&target={{ grains['fqdn'] }}.load_avg.fifteen&target={{ grains['fqdn'] }}.load_avg.five&target={{ grains['fqdn'] }}.load_avg.one&areaMode=stacked&tz=Europe%2FBerlin&hideLegend=true&_uniq=0.18911653803661466",
    "cpu-util-%": "iframe:http://metrics.oommm.de//render?width=400&from=-6hours&until=now&height=150&target=alias({{ grains['fqdn'] }}.cpu.system%2C%22sys%22)&target=alias({{ grains['fqdn'] }}.cpu.user%2C%22user%22)&target=alias({{ grains['fqdn'] }}.cpu.nice%2C%22nice%22)&target=alias(sumSeries({{ grains['fqdn'] }}.cpu.nice%2C{{ grains['fqdn'] }}.cpu.system%2C{{ grains['fqdn'] }}.cpu.user%2C{{ grains['fqdn'] }}.cpu.iowait)%2C%22sum%22)&target=alias({{ grains['fqdn'] }}.cpu.iowait%2C%22iowait%22)&tz=Europe%2FBerlin&areaMode=stacked&yMax=100&_uniq=0.5886023430851489"
  }
}
